<div class="chat-wrapper">
  <button class="volver-btn" (click)="gotoHome()">
    <i class="fas fa-arrow-left"></i> Volver
  </button>

  <div class="chat-card">
    <!-- Header -->
    <div class="chat-header">
      <div class="bot-info">
        <div class="bot-avatar">
          <img
            src="assets/bot-avatar.png"
            alt="Bot"
            onerror="this.src='https://cdn-icons-png.flaticon.com/512/4712/4712027.png'"
          />
          <span class="status-dot"></span>
        </div>
        <div class="bot-details">
          <h3>Hardware Haven Bot</h3>
          <span class="status-text">En línea</span>
        </div>
      </div>
    </div>

    <!-- Chat Body -->
    <div class="chat-body" #scrollContainer>
      <div class="message-group" *ngFor="let m of chat">
        <div
          [ngClass]="{
            'message-wrapper-user': m.startsWith('Tú:'),
            'message-wrapper-bot': m.startsWith('Bot:')
          }"
        >
          <div class="message-bubble">
            <p>{{ m.substring(m.indexOf(":") + 1).trim() }}</p>
            <span class="message-time">{{
              currentTime | date : "shortTime"
            }}</span>
          </div>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div *ngIf="isTyping" class="message-wrapper-bot typing-wrapper">
        <div class="message-bubble typing-bubble">
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer / Input -->
    <div class="chat-footer">
      <div class="input-group">
        <input
          type="text"
          [(ngModel)]="userInput"
          placeholder="Escribe tu mensaje..."
          (keydown.enter)="sendMessage()"
          [disabled]="isTyping"
        />
        <button
          class="send-btn"
          (click)="sendMessage()"
          [disabled]="!userInput.trim() || isTyping"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>
