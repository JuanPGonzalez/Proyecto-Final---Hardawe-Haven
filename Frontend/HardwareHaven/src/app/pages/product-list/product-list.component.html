<div>
  <header>
    <nav class="navbar navbar-expand-lg">
      <div class="container-fluid">
        <a class="navbar-brand" href="productList">
          <img
            src="assets/images/title_home.png"
            class="img-fluid title_home"
            alt="Hardware Haven"
          />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <div class="d-flex justify-content-center w-100 my-2 my-lg-0">
            <div class="w-100 w-lg-50" style="max-width: 600px">
              <form
                class="d-flex w-100"
                role="search"
                (submit)="onSearch($event)"
              >
                <input
                  class="form-control form-control-dark me-2"
                  type="search"
                  placeholder="Buscar productos..."
                  aria-label="Search"
                  [(ngModel)]="searchQuery"
                  name="searchQuery"
                />
                <button class="btn btn-primary-gradient" type="submit">
                  <i class="bi bi-search"></i> Buscar
                </button>
              </form>
            </div>
          </div>
          <div class="d-flex align-items-center">
            <app-user-nav [usuario]="usuario"></app-user-nav>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main class="container-fluid py-4">
    <div class="text-center mb-5">
      <h1 class="title-product">Nuestros Productos</h1>
      <p class="text-muted">Explora el mejor hardware para tu setup</p>
    </div>

    <div class="row">
      <!-- Sidebar Filters (Left) -->
      <aside class="col-lg-3 mb-4 mb-lg-0">
        <div class="glass-card p-4">
          <h4 class="mb-3">Filtros</h4>

          <div class="mb-3">
            <label class="form-label text-muted small">Categorías</label>
            <select
              class="form-select form-control-dark"
              (change)="onSortChangeMenu($event)"
            >
              <option value="Or" selected>Todas las Categorías</option>
              <option
                *ngFor="let categoria of categorias"
                [value]="categoria.descripcion"
              >
                {{ categoria.descripcion }}
              </option>
            </select>
          </div>

          <div class="mb-3">
            <label class="form-label text-muted small">Orden</label>
            <select
              class="form-select form-control-dark"
              (change)="onSortChangeOrden($event)"
            >
              <option value="Or" selected>Revelancia</option>
              <option value="az">Nombre (A-Z)</option>
              <option value="za">Nombre (Z-A)</option>
              <option value="highPrice">Mayor Precio</option>
              <option value="lowPrice">Menor Precio</option>
            </select>
          </div>
        </div>
      </aside>

      <!-- Main Content (Right) -->
      <div class="col-lg-9">
        <!-- Featured Carousel -->
        <div class="mb-5" *ngIf="products.length > 0">
          <h3 class="mb-4 ps-3 border-start border-4 border-primary">
            Destacados
          </h3>
          <div
            id="productsCarousel"
            class="carousel slide"
            data-bs-ride="carousel"
          >
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="row g-4">
                  <div
                    class="col-12 col-sm-6 col-md-4 col-lg-3"
                    *ngFor="let product of products.slice(0, 4)"
                  >
                    <app-card
                      [product]="product"
                      (productSelected)="onProductSelected($event)"
                      (productUnSelected)="onProductUnSelected($event)"
                    ></app-card>
                  </div>
                </div>
              </div>
              <div class="carousel-item" *ngIf="products.length > 4">
                <div class="row g-4">
                  <div
                    class="col-12 col-sm-6 col-md-4 col-lg-3"
                    *ngFor="let product of products.slice(4, 8)"
                  >
                    <app-card
                      [product]="product"
                      (productSelected)="onProductSelected($event)"
                      (productUnSelected)="onProductUnSelected($event)"
                    ></app-card>
                  </div>
                </div>
              </div>
            </div>
            <button
              class="carousel-control-prev"
              type="button"
              data-bs-target="#productsCarousel"
              data-bs-slide="prev"
              style="width: 5%"
            >
              <span
                class="carousel-control-prev-icon"
                aria-hidden="true"
              ></span>
            </button>
            <button
              class="carousel-control-next"
              type="button"
              data-bs-target="#productsCarousel"
              data-bs-slide="next"
              style="width: 5%"
            >
              <span
                class="carousel-control-next-icon"
                aria-hidden="true"
              ></span>
            </button>
          </div>
        </div>

        <!-- All Products Grid -->
        <div>
          <h3 class="mb-4 ps-3 border-start border-4 border-primary">
            Catálogo Completo
          </h3>
          <div *ngIf="products.length > 0; else noProducts" class="row g-4">
            <div
              class="col-12 col-sm-6 col-md-4 col-lg-3"
              *ngFor="let product of products"
            >
              <app-card
                [product]="product"
                (productSelected)="onProductSelected($event)"
                (productUnSelected)="onProductUnSelected($event)"
              ></app-card>
            </div>
          </div>
          <ng-template #noProducts>
            <div class="text-center py-5">
              <h4 class="text-muted">No se encontraron productos</h4>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </main>

  <!-- Fixed Top-Right Menu -->
  <div class="custom-menu-fixed" [class.disabled]="carrito.length === 0">
    <div
      class="position-relative item-menu-fixed"
      (click)="carrito.length > 0 && pasarAcompra()"
      [style.cursor]="carrito.length === 0 ? 'not-allowed' : 'pointer'"
    >
      <img src="assets/images/Carrito.png" width="24" height="24" alt="Cart" />
      <span class="carrito-shopcar" *ngIf="carrito.length > 0">{{
        carrito.length
      }}</span>
    </div>

    <!-- Trash Button -->
    <button
      class="floating-button-trash"
      (click)="vaciarCarro()"
      [disabled]="carrito.length === 0"
      title="Vaciar Carrito"
    >
      <img src="assets/images/Tachito.png" alt="Vaciar" class="trash-icon" />
    </button>

    <button
      class="floating-button-purchase"
      (click)="pasarAcompra()"
      [disabled]="carrito.length === 0"
      title="Comprar Ahora"
    >
      <span class="text-truncate">
        {{ carrito.length > 0 ? "Comprar Ahora" : "Carrito Vacío" }}
      </span>
    </button>
  </div>
</div>
